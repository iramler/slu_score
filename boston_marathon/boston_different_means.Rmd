---
title: "Boston Marathon 2019"
author: "Jack Fay"
date: "2023-06-07"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Motivation

The Boston Marathon, a legendary event etched in the hearts of runners and 
spectators alike,represents the epitome of resilience, perseverance, and 
triumph. Year after year, participants from around the world gather, united by
a shared passion for testing their limits and embracing the relentless pursuit 
of greatness. In 2019, this storied race witnessed the rise of two extraordinary
champions who left an indelible mark on history. On the men's side, 
Lawrence Cherono, a powerhouse of determination, unleashed his formidable 
strength, pushing his body to its limits to claim victory with unparalleled 
resolve. Meanwhile, in the women's division, Worknesh Degefa demonstrated a 
relentless spirit, blazing through the course with unwavering determination, 
leaving her competitors in awe as she crossed the finish line triumphantly. 
Both Lawrence Cherono and Worknesh Degefa exemplify the very essence of the 
Boston Marathon, where dreams are transformed into reality through perseverance,
grit, and unwavering belief. Their triumphs serve as a powerful reminder that
with unwavering dedication and unyielding determination, we too can overcome any
obstacle that stands in our way, and cross our own personal finish lines, 
victorious in our pursuit of greatness.

## Data

The data set is from the 2019 Boston Marathon and contains observations for all finishers of the race.
The 'boston' data set contains 26651 total observations with each row representing a runner. 
The 'bostom_Men' data set contains 14670 observations.
The 'boston_Women data set contains 11981 obersvations. 


Variables:
*Rank_Tot - overall ranking in the race
*Age - age of the runner 
*Country - nationality of the runner 
*Result_hr - finishing time of the runner in hours minutes seconds format
*Result_sec - finishing time of the runner in seconds 
*Country_code - country abbreviation 
*gender - gender of the runner (male or female)

```{r}
# boston <- read_csv("~/Downloads/Dataset-Boston-2019.csv")
# write_csv(x = boston, file = "data/Dataset-Boston-2019.csv")

#boston_Men<-boston%>%
#  filter(gender == "M")
#write_csv(x = boston_Men, file = "data/boston_men.csv")
#boston_Women <- boston%>%
#  filter(gender == "F")
#write_csv(x = boston_Women, file = "data/boston_women.csv")

boston <- read_csv("data/Dataset-Boston-2019.csv")
bostonMen <- read_csv("data/boston_men.csv")
bostonWomen <- read_csv("data/boston_women.csv")
```

```{r}
boston<-boston%>%
  mutate(gender = factor(Gender))%>%
  select(-Gender)%>%
  na.omit()

library(forcats)
boston<-boston%>%
  mutate(age_group = fct_collapse(factor(Age),
                                  under_25 = 18:25,
                                  '26-33' = 26:33,
                                  '34-41' = 32:41,
                                  '42-49' = 42:49,
                                  '50-57' = 50:57,
                                  '58-65' = 58:65,
                                  '66+' = 66:83))

head(boston)
```

## Is there a statistical difference in means for race results for males and females?


## Side-by-side boxplot displaying gender vs result in seconds 
```{r}
ggplot(data = boston, 
        aes(x = gender, Result_sec, fill = gender))+
  geom_boxplot()
```

## Two Sample t-test to determine whether there is a difference in means
```{r}
boston %>%
with(t.test(Result_sec ~ gender))

# yes, the difference in means is statistically significant 
```

# Is age related to finishing time for Men or women?

## Scatterplot of Age vs Result_sec for men
```{r}
ggplot(data = boston_Men, 
       aes(x = Age, Result_sec, color = age_group))+
geom_point()+
  geom_smooth(method = loess, se = FALSE)


# Make a guess at the correlation

# Appears to be low
# younger runners running faster but curvature suggests that times become faster from age 20-30
```


```{r}
ggplot(data = boston_Women, 
       aes(x = Age, Result_sec, color = age_group))+
geom_point()+
  geom_smooth(method = loess, se = FALSE)

# Make another guess and compare which seems greater
# see a similar trend but bigger dip in times from 20 to roughly 35 before becoming more linear
```

```{r}
cor(boston_Men$Age, boston_Men$Result_sec)
cor(boston_Women$Age, boston_Women$Result_sec)

# Despite low correlation in both cases, it is higher for men than women
```

```{r}
ggplot(data = boston,
       aes(x = age_group, y = Result_sec, fill = age_group))+
  geom_boxplot()
```


# Calculating z-scores for top Male and Female finishers to see which was more remarkable in comaprison to the field

## Histograms of the results respectively for male and female

```{r}
hist(boston_Men$Result_sec)
hist(boston_Women$Result_sec)
```

# Finding mean and standard deviation for male runners and calculating z-score

```{r}
# find mean and standard deviation of MENS results in seconds
boston_Men%>%
  summarise(mean_result_sec = mean(Result_sec),
            sd_result_sec = sd(Result_sec))

# mean = 13377.54
#sd = 2737.843

# 1st place male runner
boston_Men%>%
  slice_min(Result_sec)

zscore <- (7677 - 13377.54) / 2737.843
zscore
#z-score of -2.082128
```

# Finding mean and standard deviation for female runners and calculating z-score
```{r}
boston_Women%>%
  summarise(mean_result_sec = mean(Result_sec),
            sd_result_sec = sd(Result_sec))

# mean = 14717.8
#sd = 2454.376

# 1st place female runner
boston_Women%>%
  slice_min(Result_sec)

zscore <- (8611 - 14717.8) / 2454.376
zscore
# z-score of -2.488127
```

# In conclusion, the top female finishers result was more remarkable for that day in relation to the female field
# than the top male finisher because the score was further from zero.




