---
title: "Boston Marathon 2019"
author: "Jack Fay"
date: "2023-06-07"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

Motivation:

The Boston Marathon goes beyond a mere race; it embodies the spirit of endurance and unwavering determination. Taking place on a historic track spanning 26.2 miles, this marathon signifies the triumph of pushing physical and mental limits. It celebrates the human capacity to overcome boundaries and inspire greatness within oneself and others. Through dedicated training, sacrifices, and personal growth, participants converge at the starting line, epitomizing resilience. The Boston Marathon encapsulates the unwavering spirit that propels individuals to conquer the challenging distance, weaving together a remarkable tapestry of strength and inspiration.


The data set is from the 2019 Boston Marathon and contains observations for all finishers of the race.

Variables:
*Rank_Tot - overall ranking in the race
*Age - age of the runner 
*Country - nationality of the runner 
*Result_hr - finishing time of the runner in hours minutes seconds format
*Result_sec - finishing time of the runner in seconds 
*Country_code - country abbreviation 
*gender - gender of the runner (male or female)

```{r}
boston <- read_csv("~/Downloads/Dataset-Boston-2019.csv")

write_csv(x = boston, file = "data/Dataset-Boston-2019.csv")

```

```{r}
boston<-boston%>%
  mutate(gender = factor(Gender))%>%
  select(-Gender)%>%
  na.omit()

head(boston)
```

# Is gender related to finishing time?


## Side-by-side boxplot displaying gender vs result in seconds 
```{r}
ggplot(data = boston, 
        aes(x = gender, Result_sec, fill = gender))+
  geom_boxplot()
```

## Two Sample t-test to determine whether there is a difference in means
```{r}
boston %>%
with(t.test(Result_sec ~ gender))

# yes, the difference in means is statsistically significant 
```




# Calculating z-scores for top Male and Female finishers to see which was more remarkable in comaprison to the field

## Histograms of the results respectively for male and female 
```{r}
boston_Men<-boston%>%
  filter(gender == "M")

boston_Women <- boston%>%
  filter(gender == "F")

hist(boston_Men$Result_sec)
hist(boston_Women$Result_sec)
```

```{r}
# find mean and standard deviation of MENS results in seconds
boston_Men%>%
  summarise(mean_result_sec = mean(Result_sec),
            sd_result_sec = sd(Result_sec))

# mean = 13377.54
#sd = 2737.843

# 1st place male runner
boston_Men%>%
  slice_min(Result_sec)

zscore <- (7677 - 13377.54) / 2737.843
zscore
#z-score of -2.082128

# find mean and standard deviation of WOMENS results in seconds
boston_Women%>%
  summarise(mean_result_sec = mean(Result_sec),
            sd_result_sec = sd(Result_sec))

# mean = 14717.8
#sd = 2454.376

# 1st place female runner
boston_Women%>%
  slice_min(Result_sec)

zscore <- (8611 - 14717.8) / 2454.376
zscore
# z-score of -2.488127

# In conclusion, the top female finishers result was more remarkable for that day in relation to the female field
# than the top male finisher because the score was further from zero.
```


# Is age related to finishing time for Men or women?

## Scatterplot of Age vs Result_sec for men
```{r}
ggplot(data = boston_Men, 
       aes(x = Age, Result_sec))+
geom_point()+
  geom_smooth(method = lm, se = FALSE)


# Make a guess at the correlation

# Appears to be low
# But trend is older runners doing better
```


```{r}
ggplot(data = boston_Women, 
       aes(x = Age, Result_sec))+
geom_point()+
  geom_smooth(method = lm, se = FALSE)

# Make another guess and compare which seems greater

```

```{r}
cor(boston_Men$Age, boston_Men$Result_sec)
cor(boston_Women$Age, boston_Women$Result_sec)

# Despite low correlation in both cases, it is higher for men than women
```



